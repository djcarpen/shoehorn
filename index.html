<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Shoehorn : How to create Hive UDF in Scala">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Shoehorn</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/djcarpen/shoehorn">View on GitHub</a>

          <h1 id="project_title">Shoehorn</h1>
          <h2 id="project_tagline">How to create Hive UDF in Scala</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/djcarpen/shoehorn/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/djcarpen/shoehorn/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3>
<a id="abstract" class="anchor" href="#abstract" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Abstract</h3>

<p>There are many articles on how to extend the capabilities of Apache Hive with the use of custom UDFs (User Defined Functions) written in java. This article will focus on how to create a UDF in the Scala programming language. Once we create the UDF, we will test it on the Hortonworks Sandbox 2.4.</p>

<h3>
<a id="environment" class="anchor" href="#environment" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Environment</h3>

<ul>
<li>Intellij IDEA 2016</li>
<li>Oracle Virtual Box</li>
<li>Hortonworks Sandbox 2.4</li>
</ul>

<h3>
<a id="artifact-produced" class="anchor" href="#artifact-produced" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Artifact produced</h3>

<ul>
<li>shoehorn.jar</li>
</ul>

<h3>
<a id="create-project" class="anchor" href="#create-project" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create project.</h3>

<p>Using Intellij IDEA, create a new project with the following configuration.</p>

<ul>
<li>Project type: Scala</li>
<li>Project name: shoehorn</li>
<li>Project SDK: 1.8 (java version 1.8)</li>
<li>Scala SDK: scala-sdk-2.11.8</li>
</ul>

<h3>
<a id="create-package" class="anchor" href="#create-package" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create package</h3>

<p>Once the project is created, add a package under /shoehorn/src/ named: udf</p>

<h3>
<a id="set-dependencies" class="anchor" href="#set-dependencies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Set dependencies</h3>

<p>Edit your project structure and add the <a href="http://repo1.maven.org/maven2/org/apache/hive/hive-exec/1.2.1/hive-exec-1.2.1.jar">hive-exec-1.2.1.jar</a> file to the module dependencies.</p>

<h3>
<a id="create-artifact" class="anchor" href="#create-artifact" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create Artifact</h3>

<p>Edit your project structure and add and artifact of type JAR&gt;module with dependencies. For this example, I am adding the artifact to the shoehorn module.</p>

<h3>
<a id="create-scala-class" class="anchor" href="#create-scala-class" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create Scala class</h3>

<p>The first thing we need to do is create a Scala class referencing the org.apache.hadoop.hive.ql.exec.UDF library. For this example, the class name is ScalaUDF. </p>

<pre><code>package udf

import org.apache.hadoop.hive.ql.exec.UDF

class ScalaUDF extends UDF {
}
</code></pre>

<h3>
<a id="define-function" class="anchor" href="#define-function" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Define function</h3>

<p>Now we add our function definition inside the ScalaUDF definition. For this example, I'm creating a simple function that takes an input column of string type and returns the length of that string. This function is for demonstration purposes only as there is already a Hive function that provides the same functionality. </p>

<pre><code>package udf

import org.apache.hadoop.hive.ql.exec.UDF

class ScalaUDF extends UDF {
  def evaluate(str: String): Int = {
    str.length()
  }
}
</code></pre>

<h3>
<a id="create-artifact-1" class="anchor" href="#create-artifact-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create artifact</h3>

<p>Using Intellij IDEA select Build&gt;"Make Project" from the file menu. Next, select Build&gt;"Build Artifacts...". This will create the /shoehorn/out/artifacts/shoehorn_jar/shoehorn.jar file.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Shoehorn maintained by <a href="https://github.com/djcarpen">djcarpen</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
